// ==UserScript==
// @name         GitHub conversation list avatars
// @version      1
// @description  Add avatars in GitHub's conversation list
// @author       kidonng
// @namespace    https://github.com/kidonng/cherry
// @match        https://github.com/*
// ==/UserScript==
(()=>{var ge=Object.create;var W=Object.defineProperty;var ye=Object.getOwnPropertyDescriptor;var we=Object.getOwnPropertyNames;var Se=Object.getPrototypeOf,xe=Object.prototype.hasOwnProperty;var be=r=>W(r,"__esModule",{value:!0});var Q=(r,s)=>()=>(s||r((s={exports:{}}).exports,s),s.exports);var Me=(r,s,d)=>{if(s&&typeof s=="object"||typeof s=="function")for(let x of we(s))!xe.call(r,x)&&x!=="default"&&W(r,x,{get:()=>s[x],enumerable:!(d=ye(s,x))||d.enumerable});return r},Ae=r=>Me(be(W(r!=null?ge(Se(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r);var Y=Q((U,X)=>{(function(r,s){typeof define=="function"&&define.amd?define([],s):typeof U=="object"?X.exports=s():r.SelectorSet=s()})(U,function(){"use strict";function r(){if(!(this instanceof r))return new r;this.size=0,this.uid=0,this.selectors=[],this.selectorObjects={},this.indexes=Object.create(this.indexes),this.activeIndexes=[]}var s=window.document.documentElement,d=s.matches||s.webkitMatchesSelector||s.mozMatchesSelector||s.oMatchesSelector||s.msMatchesSelector;r.prototype.matchesSelector=function(o,f){return d.call(o,f)},r.prototype.querySelectorAll=function(o,f){return f.querySelectorAll(o)},r.prototype.indexes=[];var x=/^#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;r.prototype.indexes.push({name:"ID",selector:function(f){var l;if(l=f.match(x))return l[0].slice(1)},element:function(f){if(f.id)return[f.id]}});var A=/^\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;r.prototype.indexes.push({name:"CLASS",selector:function(f){var l;if(l=f.match(A))return l[0].slice(1)},element:function(f){var l=f.className;if(l){if(typeof l=="string")return l.split(/\s/);if(typeof l=="object"&&"baseVal"in l)return l.baseVal.split(/\s/)}}});var C=/^((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;r.prototype.indexes.push({name:"TAG",selector:function(f){var l;if(l=f.match(C))return l[0].toUpperCase()},element:function(f){return[f.nodeName.toUpperCase()]}}),r.prototype.indexes.default={name:"UNIVERSAL",selector:function(){return!0},element:function(){return[!0]}};var O;typeof window.Map=="function"?O=window.Map:O=function(){function o(){this.map={}}return o.prototype.get=function(f){return this.map[f+" "]},o.prototype.set=function(f,l){this.map[f+" "]=l},o}();var N=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g;function P(o,f){o=o.slice(0).concat(o.default);var l=o.length,m,h,w,p,S=f,g,v,y=[];do if(N.exec(""),(w=N.exec(S))&&(S=w[3],w[2]||!S)){for(m=0;m<l;m++)if(v=o[m],g=v.selector(w[1])){for(h=y.length,p=!1;h--;)if(y[h].index===v&&y[h].key===g){p=!0;break}p||y.push({index:v,key:g});break}}while(w);return y}function E(o,f){var l,m,h;for(l=0,m=o.length;l<m;l++)if(h=o[l],f.isPrototypeOf(h))return h}r.prototype.logDefaultIndexUsed=function(){},r.prototype.add=function(o,f){var l,m,h,w,p,S,g,v,y=this.activeIndexes,b=this.selectors,D=this.selectorObjects;if(typeof o=="string"){for(l={id:this.uid++,selector:o,data:f},D[l.id]=l,g=P(this.indexes,o),m=0;m<g.length;m++)v=g[m],w=v.key,h=v.index,p=E(y,h),p||(p=Object.create(h),p.map=new O,y.push(p)),h===this.indexes.default&&this.logDefaultIndexUsed(l),S=p.map.get(w),S||(S=[],p.map.set(w,S)),S.push(l);this.size++,b.push(o)}},r.prototype.remove=function(o,f){if(typeof o=="string"){var l,m,h,w,p,S,g,v,y=this.activeIndexes,b=this.selectors=[],D=this.selectorObjects,k={},T=arguments.length===1;for(l=P(this.indexes,o),h=0;h<l.length;h++)for(m=l[h],w=y.length;w--;)if(S=y[w],m.index.isPrototypeOf(S)){if(g=S.map.get(m.key),g)for(p=g.length;p--;)v=g[p],v.selector===o&&(T||v.data===f)&&(g.splice(p,1),k[v.id]=!0);break}for(h in k)delete D[h],this.size--;for(h in D)b.push(D[h].selector)}};function F(o,f){return o.id-f.id}return r.prototype.queryAll=function(o){if(!this.selectors.length)return[];var f={},l=[],m=this.querySelectorAll(this.selectors.join(", "),o),h,w,p,S,g,v,y,b;for(h=0,p=m.length;h<p;h++)for(g=m[h],v=this.matches(g),w=0,S=v.length;w<S;w++)b=v[w],f[b.id]?y=f[b.id]:(y={id:b.id,selector:b.selector,data:b.data,elements:[]},f[b.id]=y,l.push(y)),y.elements.push(g);return l.sort(F)},r.prototype.matches=function(o){if(!o)return[];var f,l,m,h,w,p,S,g,v,y,b,D=this.activeIndexes,k={},T=[];for(f=0,h=D.length;f<h;f++)if(S=D[f],g=S.element(o),g){for(l=0,w=g.length;l<w;l++)if(v=S.map.get(g[l]))for(m=0,p=v.length;m<p;m++)y=v[m],b=y.id,!k[b]&&this.matchesSelector(o,y.selector)&&(k[b]=!0,T.push(y))}return T.sort(F)},r})});var ee=Q((_,Z)=>{(function(r,s){typeof _=="object"&&typeof Z!="undefined"?s(_,Y()):typeof define=="function"&&define.amd?define(["exports","selector-set"],s):s(r.SelectorObserver={},r.SelectorSet)})(_,function(r,s){"use strict";s=s&&s.hasOwnProperty("default")?s.default:s;var d=null,x=null,A=[];function C(e,t){var n=[];function a(){var c=n;n=[],t(c)}function i(){for(var c=arguments.length,u=Array(c),M=0;M<c;M++)u[M]=arguments[M];n.push(u),n.length===1&&O(e,a)}return i}function O(e,t){x||(x=new MutationObserver(N)),d||(d=e.createElement("div"),x.observe(d,{attributes:!0})),A.push(t),d.setAttribute("data-twiddle",""+Date.now())}function N(){var e=A;A=[];for(var t=0;t<e.length;t++)try{e[t]()}catch(n){setTimeout(function(){throw n},0)}}var P=new WeakMap,E=new WeakMap,F=new WeakMap,o=new WeakMap;function f(e,t){for(var n=0;n<t.length;n++){var a=t[n],i=a[0],c=a[1],u=a[2];i===v?(l(u,c),m(u,c)):i===y?h(u,c):i===b&&w(e.observers,c)}}function l(e,t){if(t instanceof e.elementConstructor){var n=P.get(t);if(n||(n=[],P.set(t,n)),n.indexOf(e.id)===-1){var a=void 0;if(e.initialize&&(a=e.initialize.call(void 0,t)),a){var i=E.get(t);i||(i={},E.set(t,i)),i[""+e.id]=a}n.push(e.id)}}}function m(e,t){if(t instanceof e.elementConstructor){var n=o.get(t);if(n||(n=[],o.set(t,n)),n.indexOf(e.id)===-1){e.elements.push(t);var a=E.get(t),i=a?a[""+e.id]:null;if(i&&i.add&&i.add.call(void 0,t),e.subscribe){var c=e.subscribe.call(void 0,t);if(c){var u=F.get(t);u||(u={},F.set(t,u)),u[""+e.id]=c}}e.add&&e.add.call(void 0,t),n.push(e.id)}}}function h(e,t){if(t instanceof e.elementConstructor){var n=o.get(t);if(!!n){var a=e.elements.indexOf(t);if(a!==-1&&e.elements.splice(a,1),a=n.indexOf(e.id),a!==-1){var i=E.get(t),c=i?i[""+e.id]:null;if(c&&c.remove&&c.remove.call(void 0,t),e.subscribe){var u=F.get(t),M=u?u[""+e.id]:null;M&&M.unsubscribe&&M.unsubscribe()}e.remove&&e.remove.call(void 0,t),n.splice(a,1)}n.length===0&&o.delete(t)}}}function w(e,t){var n=o.get(t);if(!!n){for(var a=n.slice(0),i=0;i<a.length;i++){var c=e[a[i]];if(!!c){var u=c.elements.indexOf(t);u!==-1&&c.elements.splice(u,1);var M=E.get(t),I=M?M[""+c.id]:null;I&&I.remove&&I.remove.call(void 0,t);var j=F.get(t),q=j?j[""+c.id]:null;q&&q.unsubscribe&&q.unsubscribe(),c.remove&&c.remove.call(void 0,t)}}o.delete(t)}}var p=null;function S(e){if(p===null){var t=e.createElement("div"),n=e.createElement("div"),a=e.createElement("div");t.appendChild(n),n.appendChild(a),t.innerHTML="",p=a.parentNode!==n}return p}function g(e){return"matches"in e||"webkitMatchesSelector"in e||"mozMatchesSelector"in e||"oMatchesSelector"in e||"msMatchesSelector"in e}var v=1,y=2,b=3;function D(e,t,n){for(var a=0;a<n.length;a++){var i=n[a];i.type==="childList"?(k(e,t,i.addedNodes),T(e,t,i.removedNodes)):i.type==="attributes"&&B(e,t,i.target)}S(e.ownerDocument)&&ae(e,t)}function k(e,t,n){for(var a=0;a<n.length;a++){var i=n[a];if(g(i))for(var c=e.selectorSet.matches(i),u=0;u<c.length;u++){var M=c[u].data;t.push([v,i,M])}if("querySelectorAll"in i)for(var I=e.selectorSet.queryAll(i),j=0;j<I.length;j++)for(var q=I[j],ve=q.data,$=q.elements,V=0;V<$.length;V++)t.push([v,$[V],ve])}}function T(e,t,n){for(var a=0;a<n.length;a++){var i=n[a];if("querySelectorAll"in i){t.push([b,i]);for(var c=i.querySelectorAll("*"),u=0;u<c.length;u++)t.push([b,c[u]])}}}function B(e,t,n){if(g(n))for(var a=e.selectorSet.matches(n),i=0;i<a.length;i++){var c=a[i].data;t.push([v,n,c])}if("querySelectorAll"in n){var u=o.get(n);if(u)for(var M=0;M<u.length;M++){var I=e.observers[u[M]];I&&(e.selectorSet.matchesSelector(n,I.selector)||t.push([y,n,I]))}}}function re(e,t,n){if("querySelectorAll"in n){B(e,t,n);for(var a=n.querySelectorAll("*"),i=0;i<a.length;i++)B(e,t,a[i])}}function ie(e,t,n){for(var a=0;a<n.length;a++)for(var i=n[a],c=i.form?i.form.elements:e.rootNode.querySelectorAll("input"),u=0;u<c.length;u++)B(e,t,c[u])}function ae(e,t){for(var n=0;n<e.observers.length;n++){var a=e.observers[n];if(a)for(var i=a.elements,c=0;c<i.length;c++){var u=i[c];u.parentNode||t.push([b,u])}}}function oe(e,t){var n=e.readyState;n==="interactive"||n==="complete"?O(e,t):e.addEventListener("DOMContentLoaded",O(e,t))}var se=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fe=0;function R(e){this.rootNode=e.nodeType===9?e.documentElement:e,this.ownerDocument=e.nodeType===9?e:e.ownerDocument,this.observers=[],this.selectorSet=new s,this.mutationObserver=new MutationObserver(ue.bind(this,this)),this._scheduleAddRootNodes=C(this.ownerDocument,ce.bind(this,this)),this._handleThrottledChangedTargets=C(this.ownerDocument,he.bind(this,this)),this.rootNode.addEventListener("change",de.bind(this,this),!1),oe(this.ownerDocument,le.bind(this,this))}R.prototype.disconnect=function(){this.mutationObserver.disconnect()},R.prototype.observe=function(e,t){var n=void 0;typeof t=="function"?n={selector:e,initialize:t}:(typeof t=="undefined"?"undefined":se(t))==="object"?(n=t,n.selector=e):n=e;var a=this,i={id:fe++,selector:n.selector,initialize:n.initialize,add:n.add,remove:n.remove,subscribe:n.subscribe,elements:[],elementConstructor:n.hasOwnProperty("constructor")?n.constructor:this.ownerDocument.defaultView.Element,abort:function(){a._abortObserving(i)}};return this.selectorSet.add(i.selector,i),this.observers[i.id]=i,this._scheduleAddRootNodes(),i},R.prototype._abortObserving=function(e){for(var t=e.elements,n=0;n<t.length;n++)h(e,t[n]);this.selectorSet.remove(e.selector,e),delete this.observers[e.id]},R.prototype.triggerObservers=function(e){var t=[];re(this,t,e),f(this,t)};function le(e){e.mutationObserver.observe(e.rootNode,{childList:!0,attributes:!0,subtree:!0}),e._scheduleAddRootNodes()}function ce(e){var t=[];k(e,t,[e.rootNode]),f(e,t)}function ue(e,t){var n=[];D(e,n,t),f(e,n)}function de(e,t){e._handleThrottledChangedTargets(t.target)}function he(e,t){var n=[];ie(e,n,t),f(e,n)}var G=void 0;function H(){return G||(G=new R(window.document)),G}function me(){var e;return(e=H()).observe.apply(e,arguments)}function pe(){var e;return(e=H()).triggerObservers.apply(e,arguments)}r.getDocumentObserver=H,r.observe=me,r.triggerObservers=pe,r.default=R,Object.defineProperty(r,"__esModule",{value:!0})})});var Oe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","animation","audio","canvas","circle","clipPath","color-profile","cursor","defs","desc","discard","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","handler","hkern","iframe","image","line","linearGradient","listener","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","prefetch","radialGradient","rect","script","set","solidColor","stop","style","svg","switch","symbol","tbreak","text","textArea","textPath","title","tref","tspan","unknown","use","video","view","vkern"],L=new Set(Oe);L.delete("a");L.delete("audio");L.delete("canvas");L.delete("iframe");L.delete("script");L.delete("video");var Ce=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,De=r=>r===DocumentFragment,Ie=(r,s)=>{for(let[d,x]of Object.entries(s))d.startsWith("-")?r.style.setProperty(d,x):typeof x=="number"&&!Ce.test(d)?r.style[d]=`${x}px`:r.style[d]=x},Ne=r=>typeof r=="string"?L.has(r)?document.createElementNS("http://www.w3.org/2000/svg",r):document.createElement(r):De(r)?document.createDocumentFragment():r(r.defaultProps),z=(r,s,d)=>{d!=null&&(/^xlink[AHRST]/.test(s)?r.setAttributeNS("http://www.w3.org/1999/xlink",s.replace("xlink","xlink:").toLowerCase(),d):r.setAttribute(s,d))},J=(r,s)=>{for(let d of s)d instanceof Node?r.appendChild(d):Array.isArray(d)?J(r,d):typeof d!="boolean"&&typeof d!="undefined"&&d!==null&&r.appendChild(document.createTextNode(d))},ke=(r,s,...d)=>{var x;let A=Ne(r);if(J(A,d),A instanceof DocumentFragment||!s)return A;for(let[C,O]of Object.entries(s))if(C==="htmlFor"&&(C="for"),C==="class"||C==="className"){let N=(x=A.getAttribute("class"))!==null&&x!==void 0?x:"";z(A,"class",(N+" "+String(O)).trim())}else if(C==="style")Ie(A,O);else if(C.startsWith("on")){let N=C.slice(2).toLowerCase().replace(/^-/,"");A.addEventListener(N,O)}else C==="dangerouslySetInnerHTML"&&"__html"in O?A.innerHTML=O.__html:C!=="key"&&O!==!1&&z(A,C,O===!0?"":O);return A},Ee=typeof DocumentFragment=="function"?DocumentFragment:()=>{},Fe={createElement:ke,Fragment:Ee},K=Fe;var te=Ae(ee()),ne="gcla-processed";(0,te.observe)(`:is(.js-issue-row, .js-pinned-issue-list-item) [data-hovercard-type="user"]:not(.${ne})`,{add(r){r.classList.add(ne);let s=r.textContent,d=16;r.prepend(K.createElement("img",{className:"avatar-user v-align-text-bottom",src:`https://avatars.githubusercontent.com/${s}?size=${d*devicePixelRatio}`,width:d})," ")}});})();
